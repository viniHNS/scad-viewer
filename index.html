<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SCAD Web Viewer ‚Äî OpenSCAD no Navegador</title>
  <meta name="description"
    content="Compile e visualize arquivos OpenSCAD (.scad) diretamente no navegador usando WebAssembly. Nenhuma instala√ß√£o necess√°ria." />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' fill='none'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='32' y2='32'%3E%3Cstop stop-color='%2306b6d4'/%3E%3Cstop offset='1' stop-color='%23a855f7'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect x='4' y='4' width='24' height='24' rx='4' stroke='url(%23g)' stroke-width='2.5'/%3E%3Cpath d='M10 22 L16 10 L22 22' stroke='url(%23g)' stroke-width='2.2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E" />

  <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.170.0/build/three.module.min.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.170.0/examples/jsm/"
    }
  }
  </script>
</head>

<body>
  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <header id="app-header">
    <div class="header-brand">
      <svg class="logo-icon" viewBox="0 0 32 32" width="28" height="28" fill="none">
        <rect x="4" y="4" width="24" height="24" rx="4" stroke="url(#grd)" stroke-width="2.5" />
        <path d="M10 22 L16 10 L22 22" stroke="url(#grd)" stroke-width="2.2" stroke-linecap="round"
          stroke-linejoin="round" fill="none" />
        <defs>
          <linearGradient id="grd" x1="0" y1="0" x2="32" y2="32">
            <stop stop-color="#06b6d4" />
            <stop offset="1" stop-color="#a855f7" />
          </linearGradient>
        </defs>
      </svg>
      <h1>SCAD <span class="accent">Web</span></h1>
    </div>
    <div class="header-right">
      <p class="header-tagline">Compile &amp; visualize OpenSCAD no navegador</p>
      <button id="btn-tips" class="btn-tips" title="Dicas">
        <svg viewBox="0 0 20 20" width="15" height="15" fill="none">
          <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="1.6" />
          <path d="M10 9v4M10 6.5v.01" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
        </svg>
        Dicas
      </button>
    </div>
  </header>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Tips Modal ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="tips-modal" class="modal-overlay" hidden>
    <div class="modal-card glass">
      <div class="modal-header">
        <h2>üí° Dicas</h2>
        <button id="btn-close-tips" class="btn-icon modal-close" title="Fechar">
          <svg viewBox="0 0 20 20" width="18" height="18" fill="none">
            <path d="M5 5l10 10M15 5L5 15" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
          </svg>
        </button>
      </div>
      <div class="modal-body">
        <div class="tip-item">
          <span class="tip-icon">‚è±Ô∏è</span>
          <div>
            <strong>Modelos complexos demoram mais</strong>
            <p>Pe√ßas com muitos detalhes, alta resolu√ß√£o (<code>$fn</code> alto) ou opera√ß√µes booleanas complexas podem
              levar v√°rios minutos para compilar.</p>
          </div>
        </div>
        <div class="tip-item">
          <span class="tip-icon">üéõÔ∏è</span>
          <div>
            <strong>Par√¢metros autom√°ticos</strong>
            <p>Adicione anota√ß√µes nos coment√°rios para gerar controles interativos:<br>
              <code>altura = 10; // [1:0.5:50]</code> ‚Üí slider<br>
              <code>tipo = "a"; // [a, b, c]</code> ‚Üí dropdown
            </p>
          </div>
        </div>
        <div class="tip-item">
          <span class="tip-icon">üìö</span>
          <div>
            <strong>Biblioteca BOSL2</strong>
            <p>A biblioteca BOSL2 √© carregada automaticamente quando detectada no c√≥digo. Basta usar
              <code>include &lt;BOSL2/std.scad&gt;</code> normalmente.</p>
          </div>
        </div>
        <div class="tip-item">
          <span class="tip-icon">üîç</span>
          <div>
            <strong>Dica de performance</strong>
            <p>Use <code>$fn</code> baixo (16‚Äì32) durante o desenvolvimento e aumente para a vers√£o final. Valores como
              <code>$fn=128</code> podem tornar a compila√ß√£o muito lenta.</p>
          </div>
        </div>
        <div class="tip-item">
          <span class="tip-icon">üíæ</span>
          <div>
            <strong>Exporte seu modelo</strong>
            <p>Ap√≥s compilar, use o bot√£o <strong>Baixar STL</strong> para salvar o arquivo. O STL pode ser usado em
              fatiadores como Cura ou PrusaSlicer para impress√£o 3D.</p>
          </div>
        </div>
        <div class="tip-item">
          <span class="tip-icon">üñ±Ô∏è</span>
          <div>
            <strong>Controles do visualizador</strong>
            <p>Clique + arraste para girar ¬∑ Scroll para zoom ¬∑ Clique direito + arraste para mover a c√¢mera.</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Main Layout ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <main id="app-main">
    <!-- Left panel: upload + tabs -->
    <aside id="panel-left">
      <!-- Upload zone -->
      <section id="upload-zone" class="card glass" tabindex="0" role="button" aria-label="Upload .scad file">
        <div class="upload-content">
          <div class="upload-icon-wrap">
            <svg class="upload-icon" viewBox="0 0 48 48" width="40" height="40" fill="none">
              <path d="M24 32V12M24 12L16 20M24 12L32 20" stroke="currentColor" stroke-width="2.5"
                stroke-linecap="round" stroke-linejoin="round" />
              <path d="M8 30v6a4 4 0 004 4h24a4 4 0 004-4v-6" stroke="currentColor" stroke-width="2.5"
                stroke-linecap="round" />
            </svg>
          </div>
          <p class="upload-label">Arraste um arquivo <strong>.scad</strong> aqui</p>
          <p class="upload-sub">ou clique para selecionar</p>
        </div>
        <input type="file" id="file-input" accept=".scad" hidden />
      </section>

      <!-- File info + compile -->
      <div id="file-info" class="card glass" hidden>
        <div class="file-info-row">
          <span class="file-name" id="file-name">‚Äî</span>
          <span class="file-size" id="file-size"></span>
        </div>
        <button id="btn-compile" class="btn-primary" disabled>
          <span class="btn-label">Compilar</span>
          <span class="spinner" hidden></span>
        </button>
      </div>

      <!-- Tabbed panel: Parameters / Console -->
      <div id="tab-container" class="card glass">
        <div class="tab-bar">
          <button class="tab-btn active" data-tab="params">
            <svg viewBox="0 0 20 20" width="14" height="14" fill="none">
              <path d="M10 3v14M3 10h14" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
            </svg>
            Par√¢metros
          </button>
          <button class="tab-btn" data-tab="console">
            <svg viewBox="0 0 20 20" width="14" height="14" fill="none">
              <path d="M4 6l4 4-4 4M10 16h6" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"
                stroke-linejoin="round" />
            </svg>
            Console
          </button>
        </div>

        <!-- Parameters tab -->
        <div class="tab-content active" id="tab-params">
          <div id="params-empty" class="params-placeholder">
            <p>Carregue um arquivo .scad para ver os par√¢metros edit√°veis.</p>
            <p class="params-hint">Dica: use vari√°veis no topo do .scad com coment√°rios para configurar par√¢metros.<br>
              Ex: <code>altura = 10; // [1:100]</code></p>
          </div>
          <div id="params-list" hidden></div>
        </div>

        <!-- Console tab -->
        <div class="tab-content" id="tab-console">
          <div class="console-toolbar">
            <button id="btn-clear-log" class="btn-icon" title="Limpar console">
              <svg viewBox="0 0 20 20" width="14" height="14" fill="none">
                <path d="M4 4l12 12M16 4L4 16" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" />
              </svg>
              Limpar
            </button>
          </div>
          <pre id="log-output"><code>Pronto. Aguardando arquivo .scad‚Ä¶</code></pre>
        </div>
      </div>
    </aside>

    <!-- Right panel: 3D viewer -->
    <section id="viewer-panel">
      <div id="viewer-container">
        <canvas id="viewer-canvas"></canvas>
        <div id="viewer-overlay" class="viewer-placeholder">
          <svg viewBox="0 0 64 64" width="56" height="56" fill="none">
            <path d="M32 6L58 20v24L32 58 6 44V20L32 6z" stroke="currentColor" stroke-width="2" opacity="0.25" />
            <path d="M32 6L58 20 32 34 6 20 32 6z" stroke="currentColor" stroke-width="2" opacity="0.35" />
            <path d="M32 34v24" stroke="currentColor" stroke-width="2" opacity="0.25" />
          </svg>
          <p>O modelo 3D aparecer√° aqui</p>
        </div>
        <!-- Compile progress -->
        <div id="compile-progress">
          <div class="progress-spinner"></div>
          <p>Compilando‚Ä¶</p>
        </div>
      </div>
      <!-- Viewer toolbar -->
      <div id="viewer-toolbar">
        <button id="btn-reset-cam" class="btn-tool" title="Resetar c√¢mera">
          <svg viewBox="0 0 20 20" width="16" height="16" fill="none">
            <path d="M3 10a7 7 0 1114 0 7 7 0 01-14 0z" stroke="currentColor" stroke-width="1.6" />
            <path d="M10 6v4l3 2" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" />
          </svg>
          Resetar
        </button>
        <button id="btn-download" class="btn-tool" title="Baixar STL" disabled>
          <svg viewBox="0 0 20 20" width="16" height="16" fill="none">
            <path d="M10 3v10M10 13l-4-4M10 13l4-4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"
              stroke-linejoin="round" />
            <path d="M3 14v2a1 1 0 001 1h12a1 1 0 001-1v-2" stroke="currentColor" stroke-width="1.6"
              stroke-linecap="round" />
          </svg>
          Baixar STL
        </button>
      </div>
    </section>
  </main>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ Footer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <footer id="app-footer">
    <span class="footer-left">Feito com <a href="https://aka.ms/confidential" target="_blank" rel="noopener"
        class="heart-link">‚ù§Ô∏è</a></span>
    <span class="footer-right">
      Feito por <strong>Vinicius Nishida</strong>
      <a href="https://github.com/viniHNS" target="_blank" rel="noopener" title="GitHub" class="footer-icon">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
          <path
            d="M12 0C5.37 0 0 5.37 0 12c0 5.3 3.438 9.8 8.205 11.387.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.387-1.333-1.756-1.333-1.756-1.09-.745.083-.73.083-.73 1.205.085 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.42-1.305.762-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.694.825.576C20.565 21.795 24 17.295 24 12c0-6.63-5.37-12-12-12z" />
        </svg>
      </a>
      <a href="https://www.linkedin.com/in/vinicius-hissayoshi-nishida-5b26a21b0/" target="_blank" rel="noopener"
        title="LinkedIn" class="footer-icon">
        <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
          <path
            d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z" />
        </svg>
      </a>
    </span>
  </footer>

  <script type="module" src="app.js"></script>
</body>

</html>